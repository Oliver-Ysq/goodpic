{"version":3,"sources":["components/Loading.js","components/Header.js","components/Footer.js","App.js","reportWebVitals.js","index.js","models/index.js","stores/user.js","stores/history.js","stores/image.js","stores/auth.js","stores/index.js"],"names":["Loading","Header","styled","header","Logo","img","StyledLink","NavLink","Login","div","MyButton","Button","MyText","span","Component","observer","useStores","UserStore","AuthStore","history","useHistory","src","to","activeClassName","exact","currentUser","attributes","username","type","onClick","logout","console","log","push","Footer","footer","Home","lazy","History","About","Register","App","fallback","path","component","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","document","getElementById","AV","init","appId","appKey","serverURL","Auth","password","user","User","setUsername","setPassword","Promise","resolve","reject","signUp","loginedUser","error","logIn","logOut","current","Uploader","file","filename","item","Object","avFile","File","set","save","res","catch","err","objId","image","createWithoutData","destroy","page","limit","query","Query","include","skip","descending","equalTo","find","makeAutoObservable","this","list","isLoading","hasMore","newList","concat","append","length","message","warning","finally","objItem","success","filter","id","serverFile","isUploading","newFilename","newFile","values","name","pullUser","resetUser","HistoryStore","reset","ImageStore","context","createContext","useContext"],"mappings":"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","file":"static/js/main.7418e62a.chunk.js","sourcesContent":["import React from 'react'\r\n\r\nfunction Loading() {\r\n    return (\r\n        <>\r\n            <div>Loading...</div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Loading","import React from \"react\";\r\nimport styled from \"styled-components\";\r\nimport { Button } from \"antd\";\r\nimport { useStores } from \"../stores\";\r\nimport { observer } from \"mobx-react\";\r\nimport { NavLink, useHistory } from \"react-router-dom\";\r\n\r\nconst Header = styled.header`\r\n  background-color: #102a38;\r\n  padding: 10px 140px;\r\n  display: flex;\r\n  align-items: center;\r\n  color: #fff;\r\n  @media screen and (max-width: 500px) {\r\n    padding: 10px 10px;\r\n    justify-content: space-between;\r\n  }\r\n`;\r\nconst Logo = styled.img`\r\n  height: 30px;\r\n  @media screen and (max-width: 500px) {\r\n    display: none;\r\n  }\r\n`;\r\nconst StyledLink = styled(NavLink)`\r\n  color: #fff;\r\n  margin-left: 30px;\r\n  &.active {\r\n    border-bottom: 1px solid #fff;\r\n  }\r\n  @media screen and (max-width: 500px) {\r\n    margin-left: 12px;\r\n  }\r\n`;\r\nconst Login = styled.div`\r\n  @media screen and (min-width: 500px) {\r\n    margin-left: auto;\r\n  }\r\n`;\r\nconst MyButton = styled(Button)`\r\n  margin-left: 20px;\r\n  text-align: center;\r\n  background: #288388;\r\n  border-color: #288388;\r\n  @media screen and (max-width: 500px) {\r\n    margin-left: 5px;\r\n  }\r\n`;\r\nconst MyText = styled.span`\r\n  margin-right: 10px;\r\n`\r\n\r\nconst Component = observer(() => {\r\n  const { UserStore, AuthStore } = useStores();\r\n  let history = useHistory();\r\n\r\n  const handleLogin = () => {\r\n    console.log(\"跳转到登录页面\");\r\n    history.push(\"/login\");\r\n  };\r\n  const handleLogout = () => {\r\n    AuthStore.logout();\r\n  };\r\n  const handleRegister = () => {\r\n    console.log(\"跳转道注册页面\");\r\n    history.push(\"/register\");\r\n  };\r\n  return (\r\n    <Header>\r\n      <Logo src=\"image.png\" />\r\n      <nav>\r\n        <StyledLink to=\"/\" activeClassName=\"active\" exact>\r\n          首页\r\n        </StyledLink>\r\n        <StyledLink to=\"/history\" activeClassName=\"active\">\r\n          图片仓库\r\n        </StyledLink>\r\n        <StyledLink to=\"/about\" activeClassName=\"active\">\r\n          关于我\r\n        </StyledLink>\r\n      </nav>\r\n      <Login>\r\n        {UserStore.currentUser ? (\r\n          <>\r\n            <MyText>{UserStore.currentUser.attributes.username}</MyText>\r\n            <MyButton type=\"primary\" onClick={handleLogout}>\r\n              注销\r\n            </MyButton>\r\n          </>\r\n        ) : (\r\n          <>\r\n            <MyButton type=\"primary\" onClick={handleLogin}>\r\n              登录\r\n            </MyButton>\r\n            <MyButton type=\"primary\" onClick={handleRegister}>\r\n              注册\r\n            </MyButton>\r\n          </>\r\n        )}\r\n      </Login>\r\n    </Header>\r\n  );\r\n});\r\n\r\nexport default Component;\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nconst Footer = styled.footer`\r\n  padding: 10px 100px;\r\n  text-align: center;\r\n  font-size: 12px;\r\n  color: #aaa;\r\n`\r\n\r\nfunction Component() {\r\n    return (\r\n        <Footer>\r\n            <div>Footer</div>\r\n        </Footer>\r\n    )\r\n}\r\n\r\nexport default Component","import './App.css';\nimport {Switch, Route} from 'react-router-dom';\nimport Loading from \"./components/Loading\";\nimport Header from \"./components/Header\";\nimport Footer from \"./components/Footer\";\nimport React, {Suspense, lazy} from \"react\";\n\nconst Home = lazy(() => import(\"./pages/Home\"));\nconst History = lazy(() => import(\"./pages/History\"));\nconst About = lazy(() => import(\"./pages/About\"));\nconst Login = lazy(() => import(\"./pages/Login\"));\nconst Register = lazy(() => import(\"./pages/Register\"));\n\nfunction App() {\n    return (<>\n            <Header/>\n            <main>\n                <Suspense fallback={<Loading/>}>   {/* 异步加载 */}\n                    <Switch>\n                        {/*等价于  <Route path='/' exact><Home/></Route> */}\n                        <Route path='/' exact component={Home}/>\n                        <Route path='/about' exact component={About}/>\n                        <Route path='/history' exact component={History}/>\n                        <Route path='/login' exact component={Login}/>\n                        <Route path='/register' exact component={Register}/>\n                    </Switch>\n                </Suspense>\n            </main>\n            <Footer/>\n        </>);\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport {\n    HashRouter as Router\n} from 'react-router-dom'\n\nReactDOM.render(\n    <Router> <App/> </Router>,\n    document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","import AV, { User } from \"leancloud-storage\";\r\n\r\nAV.init({\r\n  appId: \"r8HD9RIzlGPlMbICACP43g2h-gzGzoHsz\",\r\n  appKey: \"1xP5D2JMXisB84jIKzSlX30c\",\r\n  serverURL: \"https://r8hd9riz.lc-cn-n1-shared.com\",\r\n});\r\n\r\nexport const Auth = {\r\n  register(username, password) {\r\n    let user = new User();\r\n    user.setUsername(username);\r\n    user.setPassword(password);\r\n    return new Promise((resolve, reject) => {\r\n      user.signUp().then(\r\n        (loginedUser) => {\r\n          resolve(loginedUser);\r\n        },\r\n        (error) => {\r\n          reject(error);\r\n        }\r\n      );\r\n    });\r\n  },\r\n  Login(username, password) {\r\n    return new Promise((resolve, reject) => {\r\n      User.logIn(username, password).then(\r\n        (loginedUser) => {\r\n          resolve(loginedUser);\r\n        },\r\n        (error) => {\r\n          reject(error);\r\n        }\r\n      );\r\n    });\r\n  },\r\n  Logout() {\r\n    User.logOut();\r\n  },\r\n  getCurrentUser() {\r\n    return User.current();\r\n  },\r\n};\r\n\r\nexport const Uploader = {\r\n  add(file, filename) {\r\n    const item = new AV.Object(\"Image\");\r\n    const avFile = new AV.File(filename, file);\r\n    item.set(\"filename\", filename);\r\n    item.set(\"owner\", AV.User.current());\r\n    item.set(\"url\", avFile);\r\n    return new Promise((resolve, reject) => {\r\n      item\r\n        .save()\r\n        .then((res) => {\r\n          resolve(res);\r\n        })\r\n        .catch((err) => {\r\n          reject(err);\r\n        });\r\n    });\r\n  },\r\n\r\n  deleteItem(objId) {\r\n    console.log(objId);\r\n    const image = AV.Object.createWithoutData(\"Image\", objId);\r\n    return new Promise((resolve, reject) => {\r\n      image\r\n        .destroy()\r\n        .then((res) => resolve(res))\r\n        .catch((err) => reject(err));\r\n    });\r\n  },\r\n\r\n  find({ page = 0, limit = 5 }) {\r\n    const query = new AV.Query(\"Image\");\r\n    query.include(\"owner\");\r\n    query.limit(limit);\r\n    query.skip(page * limit);\r\n    query.descending(\"createAt\");\r\n    query.equalTo(\"owner\", AV.User.current());\r\n    return new Promise((resolve, reject) => {\r\n      query\r\n        .find()\r\n        .then((res) => resolve(res))\r\n        .catch((err) => reject(err));\r\n    });\r\n  },\r\n};\r\n","import {makeAutoObservable} from \"mobx\";\r\nimport {Auth} from \"../models\";\r\n\r\nclass UserStore {\r\n    constructor() {\r\n        makeAutoObservable(this);\r\n    }\r\n\r\n    currentUser = null;\r\n\r\n    pullUser() {\r\n        this.currentUser = Auth.getCurrentUser();\r\n    }\r\n\r\n    resetUser() {\r\n        this.currentUser = null;\r\n    }\r\n}\r\n\r\nexport default new UserStore();","import { makeAutoObservable } from \"mobx\";\r\nimport { message } from \"antd\";\r\nimport { Uploader } from \"../models/index\";\r\n\r\nclass HistoryStore {\r\n  constructor() {\r\n    makeAutoObservable(this);\r\n  }\r\n\r\n  list = [];\r\n  isLoading = false;\r\n  hasMore = true;\r\n  page = 0;\r\n  limit = 5;\r\n\r\n  append(newList) {\r\n    this.list = this.list.concat(newList);\r\n  }\r\n\r\n  addPage() {\r\n    this.page++;\r\n  }\r\n\r\n  find() {\r\n    this.isLoading = true;\r\n    Uploader.find({ page: this.page, limit: this.limit })\r\n      .then((newList) => {\r\n        console.log(newList);\r\n        this.append(newList);\r\n        if (newList.length < this.limit) {\r\n          this.hasMore = false;\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        message.warning(\"加载失败\");\r\n      })\r\n      .finally(() => {\r\n        this.isLoading = false;\r\n      });\r\n  }\r\n\r\n  deleteItem(objItem) {\r\n    Uploader.deleteItem(objItem)\r\n      .then(() => {\r\n        message.success(\"删除成功\");\r\n      })\r\n      .catch(() => {\r\n        message.warning(\"删除失败\");\r\n      });\r\n    this.list = this.list.filter((item) => item.id !== objItem);\r\n  }\r\n\r\n  reset() {\r\n    this.list = [];\r\n    this.isLoading = false;\r\n    this.hasMore = true;\r\n    this.page = 0;\r\n    this.limit = 10;\r\n  }\r\n}\r\n\r\nexport default new HistoryStore();\r\n","import { message } from \"antd\";\r\nimport { makeAutoObservable } from \"mobx\";\r\nimport { Uploader } from \"../models\";\r\n\r\nclass ImageStore {\r\n  constructor() {\r\n    makeAutoObservable(this);\r\n  }\r\n\r\n  //observable\r\n  filename = \"\";\r\n  file = null;\r\n  serverFile = null;\r\n  isUploading = false;\r\n\r\n  //action\r\n  setFilename(newFilename) {\r\n    this.filename = newFilename;\r\n  }\r\n\r\n  setFile(newFile) {\r\n    this.file = newFile;\r\n  }\r\n\r\n  upload() {\r\n    this.isUploading = true;\r\n    this.serverFile = null;\r\n    return new Promise((resolve, reject) => {\r\n      Uploader.add(this.file, this.filename)\r\n        .then((serverFile) => {\r\n          this.serverFile = serverFile;\r\n          resolve(serverFile);\r\n        })\r\n        .catch((err) => {\r\n          message.warning(\"上传失败\");\r\n          reject(err);\r\n        })\r\n        .finally(() => {\r\n          this.isUploading = false;\r\n        });\r\n    });\r\n  }\r\n\r\n  reset() {\r\n    this.serverFile = null;\r\n    this.isUploading = false;\r\n  }\r\n}\r\n\r\nexport default new ImageStore();\r\n","import { makeAutoObservable } from \"mobx\";\r\nimport { Auth } from \"../models/index\";\r\nimport UserStore from \"./user\";\r\nimport HistoryStore from \"./history\";\r\nimport ImageStore from \"./image\";\r\nimport { message } from \"antd\";\r\n// import {User} from \"leancloud-storage\";\r\n\r\nclass AuthStore {\r\n  constructor() {\r\n    makeAutoObservable(this);\r\n  }\r\n\r\n  values = {\r\n    username: \"\",\r\n    password: \"\",\r\n  };\r\n\r\n  setUsername(name) {\r\n    this.values.username = name;\r\n  }\r\n\r\n  setPassword(password) {\r\n    this.values.password = password;\r\n  }\r\n\r\n  login() {\r\n    return new Promise((resolve, reject) => {\r\n      Auth.Login(this.values.username, this.values.password)\r\n        .then((user) => {\r\n          console.log(\"登录成功\");\r\n          UserStore.pullUser();\r\n          resolve(user);\r\n        })\r\n        .catch((err) => {\r\n          message.warning(\"登陆失败\");\r\n          UserStore.resetUser();\r\n          reject(err);\r\n        });\r\n    });\r\n  }\r\n\r\n  register() {\r\n    return new Promise((resolve, reject) => {\r\n      Auth.register(this.values.username, this.values.password)\r\n        .then((user) => {\r\n          console.log(\"注册成功\");\r\n          UserStore.pullUser();\r\n          resolve(user);\r\n        })\r\n        .catch((err) => {\r\n          message.warning(\"注册失败\");\r\n          UserStore.resetUser();\r\n          reject(err);\r\n        });\r\n    });\r\n  }\r\n\r\n  logout() {\r\n    Auth.Logout();\r\n    UserStore.resetUser();\r\n    HistoryStore.reset();\r\n    ImageStore.reset();\r\n  }\r\n}\r\n\r\nexport default new AuthStore();\r\n","import {createContext, useContext} from 'react';\r\nimport AuthStore from './auth';\r\nimport UserStore from './user';\r\nimport ImageStore from './image';\r\nimport HistoryStore from './history'\r\n// 创建上下文\r\nconst context = createContext({\r\n    AuthStore, UserStore, ImageStore,HistoryStore\r\n});\r\n\r\nexport const useStores = () => useContext(context);"],"sourceRoot":""}